$(function(){$(".todoList").sortable({placeholder:"ui-state-highlight",axis:"y",revert:250,tolerance:"pointer",containment:"document",forcePlaceholderSize:!0,start:function(t,o){o.placeholder.height(o.item.height()),o.item.css("opacity","0.6"),o.placeholder.css("background-color","#CFF5F2")},update:function(){var t=$(".todoList").sortable("toArray");t=$.map(t,function(t,o){return t.replace("todo-","")}),$.get("ajax/todo.php",{action:"rearrange",positions:t},function(t){1==t?$(".todo").animate({backgroundColor:"#C9FFC9"},100).animate({backgroundColor:"#F9F9F9"},1e3):$(".todo").animate({backgroundColor:"#FFC9C9"},100).animate({backgroundColor:"#F9F9F9"},1e3)})},stop:function(t,o){o.item.css({top:"0",left:"0"}),o.item.css("opacity","1")}});var t;$(document).on("dblclick",".todo",function(){$(this).find("a.edit").click()}),$(document).on("click",".todo a",function(o){(t=$(this).closest(".todo")).data("id",t.attr("id").replace("todo-","")),o.preventDefault()}),$(document).on("click",".todo a.delete",function(){$.get("ajax/todo.php",{action:"delete",id:t.data("id")},function(o){t.fadeOut("fast")})}),$(document).on("click",".todo a.done, .todo a.notdone",function(){var o=$(this),e="#"+t.attr("id")+" div.text";$.get("ajax/todo.php",{action:"done",id:t.data("id")},function(t){o.hasClass("notdone")?(o.removeClass("notdone").addClass("done"),$(e).css({"text-decoration":"line-through",color:"#CCC"}),console.log($(e).html())):(o.removeClass("done").addClass("notdone"),$(e).css({"text-decoration":"none",color:"#626262"}))})}),$(document).on("click",".todo a.edit",function(){var o=t.find(".text");if(t.data("origText"))return!1;t.data("origText",o.text()),$('<input type="text" class="form-control ip_xs">').val(o.text()).appendTo(o.empty()),o.append('<div class="editTodo"><a class="saveChanges" href="#">Save</a> or <a class="discardChanges" href="#">Cancel</a></div>')}),$(document).on("click",".todo a.discardChanges",function(){t.find(".text").text(t.data("origText")).end().removeData("origText")}),$(document).on("click",".todo a.saveChanges",function(){var o=t.find("input[type=text]").val();$.get("ajax/todo.php",{action:"edit",id:t.data("id"),text:o}),t.removeData("origText").find(".text").text(o)});var o=0;$("#addTodo").click(function(t){if((new Date).getTime()-o<5e3)return!1;$.get("ajax/todo.php",{action:"new",text:"New Todo Item. Doubleclick to Edit.",rand:Math.random()},function(t){$(t).hide().appendTo(".todoList").fadeIn()}),o=(new Date).getTime(),$(this).timedDisable(5),t.preventDefault()})});